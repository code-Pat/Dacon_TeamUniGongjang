# stq_S_B <- rbind(b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12, b13, b14, b15, b16, b17, b18, b19, b20, b21, b22, b23, b24, b25, b26, b27, b28, b29, b30, b31, b32, b33, b34, b35, b36, b37)

# stq_S_C <- rbind(c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22)

# stq_S_D <- rbind(d1, d2, d3, d4, d5, d6, d7, d8, d9, d10, d11, d12, d13, d14, d15, d16, d17, d18, d19, d20, d21, d22, d23, d24, d25, d26, d27, d28, d29, d30, d31, d32, d33, d34, d35, d36, d37, d38, d39, d40, d41, d42, d43, d44, d45, d46, d47, d48, d49, d50, d51, d52, d53, d54)

# stq_S_F <- rbind(f1, f2, f3, f4, f5, f6, f7, f8, f9)

# write.csv(stq_S_B, 'c:/Big Data Contest/stq_S_B.csv')
library(dplyr)
library(readxl)
library(ggplot2)
library(sqldf)
library(stringr)
library(writexl)
library(kimisc)
library(tidyr)

ist <- read.csv('c:/Big Data Contest/istall.csv')
sst <- read.csv('c:/Big Data Contest/sstall.csv')


names(ist) <- c("Seq", "DATE","Day","Point_Name", "Point_No","Inflow_Spill","T6", "T7", "T8", "T9", "T10", "T11", "T12", "T13", "T14", "T15", "T16", "T17", "T18", "T19", "T20", "T21", "T22")
names(sst) <- c("Seq", "DATE","Day","Point_Name", "Point_No","Inflow_Spill","T6", "T7", "T8", "T9", "T10", "T11", "T12", "T13", "T14", "T15", "T16", "T17", "T18", "T19", "T20", "T21", "T22")

Seoul_traffic <- rbind(ist, sst)

Seoul_traffic <- Seoul_traffic %>% select(-Seq) %>% arrange(DATE, Point_No)

# write.csv(Seoul_traffic, 'c:/Big Data Contest/Seoul_traffic_nadelete.csv')

Seoul_traffic <- Seoul_traffic %>% mutate(Day_check = if_else((Day == '토' | Day == '일'), '주말', '평일'))

# 순서부여 + 3시간 단위로 시간대 합치기

Seoul_traffic <- Seoul_traffic %>% mutate(Code = row_number()) %>% 
  mutate(Time6_8 = print(Seoul_traffic$T6 + Seoul_traffic$T7 + Seoul_traffic$T8)) %>% 
  mutate(Time9_11 = print(Seoul_traffic$T9 + Seoul_traffic$T10 + Seoul_traffic$T11)) %>% 
  mutate(Time12_14 = print(Seoul_traffic$T12 + Seoul_traffic$T13 + Seoul_traffic$T14)) %>% 
  mutate(Time15_17 = print(Seoul_traffic$T15 + Seoul_traffic$T16 + Seoul_traffic$T17)) %>% 
  mutate(Time18_20 = print(Seoul_traffic$T18 + Seoul_traffic$T19 + Seoul_traffic$T20)) %>% 
  mutate(Time21_22 = print(Seoul_traffic$T21 + Seoul_traffic$T22))

# 날짜 속성 부여
Seoul_traffic <- Seoul_traffic %>% mutate(New_Date = as.Date(DATE, format = '%Y-%m-%d'))

# 월별로 뽑아내고 분기별로 값을 지정해주기
Seoul_traffic<- Seoul_traffic %>% mutate(Chrdate = as.character(DATE))

vecdate <- as.vector(Seoul_traffic$Chrdate)

Seoul_traffic <- Seoul_traffic %>% mutate(Month = str_split(vecdate, '-', simplify = TRUE)[ ,2])

Seoul_traffic <- Seoul_traffic %>% mutate(Quarter = case_when(Month == '01' ~ 'Q1',
                                                              Month == '02' ~ 'Q1',
                                                              Month == '03' ~ 'Q1',
                                                              Month == '04' ~ 'Q2',
                                                              Month == '05' ~ 'Q2',
                                                              Month == '06' ~ 'Q2',
                                                              Month == '07' ~ 'Q3',
                                                              Month == '08' ~ 'Q3',
                                                              Month == '09' ~ 'Q3',
                                                              Month == '10' ~ 'Q4',
                                                              Month == '11' ~ 'Q4',
                                                              Month == '12' ~ 'Q4'))

# 필요없는 컬럼은 제거 후 컬럼 순서 변경
Seoul_traffic <- Seoul_traffic %>% select(-T6, -T7, -T8, -T9, -T10, -T11, -T12, -T13, -T14, -T15, -T16, -T17, -T18, -T19, -T20, -T21, -T22, -DATE, -Chrdate, -Month)

Seoul_traffic <- Seoul_traffic %>% mutate(Year = str_extract(New_Date, '[0-9]{1,4}'))

Seoul_traffic <- Seoul_traffic[, c(13, 14, 15, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)]

kk = 'B-01'
ss = '유입'

Seoul_traffic_Quarter_new <- Seoul_traffic %>% group_by(Year, Quarter, Point_No, Inflow_Spill) %>% summarise(sum = sum(Time6_8, Time9_11, Time12_14, Time15_17, Time18_20, Time21_22))

# qnp <- Seoul_traffic_Quarter_new %>% filter(Point_No == kk & Inflow_Spill == ss) %>% group_by() %>% mutate(code = row_number())

qnp <- Seoul_traffic_Quarter_new %>% group_by() %>% mutate(code = row_number())

countp <- Seoul_traffic %>%  group_by(Year, Quarter, Point_No, Inflow_Spill) %>% summarise(n=n()) %>% group_by() %>% mutate(code = row_number())

# countp <- Seoul_traffic %>% filter(Point_No == kk & Inflow_Spill == ss) %>% group_by(Year, Quarter) %>% summarise(n=n()) %>% group_by() %>% mutate(code = row_number())

countp <- countp %>% select(code, n)

qnp <- qnp %>% inner_join(countp, by = c('code' = 'code')) 

qnp <- qnp %>% group_by(Year, Point_No, Inflow_Spill) %>% summarise(allsum = sum(sum), alln = sum(n))

qnp <- qnp %>% group_by() %>% mutate(seq = row_number())

# write.csv(qnp, 'c:/Big Data Contest/년도_지점_유입출_sum_n_통합데이터.csv')

#ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ유입ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
I_PN_B1 <- qnp %>% filter(Point_No == 'B-01' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B2 <- qnp %>% filter(Point_No == 'B-02' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B3 <- qnp %>% filter(Point_No == 'B-03' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B4 <- qnp %>% filter(Point_No == 'B-04' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B5 <- qnp %>% filter(Point_No == 'B-05' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B6 <- qnp %>% filter(Point_No == 'B-06' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B7 <- qnp %>% filter(Point_No == 'B-07' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B8 <- qnp %>% filter(Point_No == 'B-08' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B9 <- qnp %>% filter(Point_No == 'B-09' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B10 <- qnp %>% filter(Point_No == 'B-10' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B11 <- qnp %>% filter(Point_No == 'B-11' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B12 <- qnp %>% filter(Point_No == 'B-12' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B13 <- qnp %>% filter(Point_No == 'B-13' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B14 <- qnp %>% filter(Point_No == 'B-14' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B15 <- qnp %>% filter(Point_No == 'B-15' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B16 <- qnp %>% filter(Point_No == 'B-16' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B17 <- qnp %>% filter(Point_No == 'B-17' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B18 <- qnp %>% filter(Point_No == 'B-18' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B19 <- qnp %>% filter(Point_No == 'B-19' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B20 <- qnp %>% filter(Point_No == 'B-20' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B21 <- qnp %>% filter(Point_No == 'B-21' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B22 <- qnp %>% filter(Point_No == 'B-22' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B23 <- qnp %>% filter(Point_No == 'B-23' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B24 <- qnp %>% filter(Point_No == 'B-24' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B25 <- qnp %>% filter(Point_No == 'B-25' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B26 <- qnp %>% filter(Point_No == 'B-26' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B27 <- qnp %>% filter(Point_No == 'B-27' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B28 <- qnp %>% filter(Point_No == 'B-28' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B29 <- qnp %>% filter(Point_No == 'B-29' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B30 <- qnp %>% filter(Point_No == 'B-30' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B31 <- qnp %>% filter(Point_No == 'B-31' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B32 <- qnp %>% filter(Point_No == 'B-32' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B33 <- qnp %>% filter(Point_No == 'B-33' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B34 <- qnp %>% filter(Point_No == 'B-34' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B35 <- qnp %>% filter(Point_No == 'B-35' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B36 <- qnp %>% filter(Point_No == 'B-36' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_B37 <- qnp %>% filter(Point_No == 'B-37' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C1 <- qnp %>% filter(Point_No == 'C-01' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C2 <- qnp %>% filter(Point_No == 'C-02' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C3 <- qnp %>% filter(Point_No == 'C-03' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C4 <- qnp %>% filter(Point_No == 'C-04' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C5 <- qnp %>% filter(Point_No == 'C-05' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C6 <- qnp %>% filter(Point_No == 'C-06' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C7 <- qnp %>% filter(Point_No == 'C-07' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C8 <- qnp %>% filter(Point_No == 'C-08' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C9 <- qnp %>% filter(Point_No == 'C-09' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C10 <- qnp %>% filter(Point_No == 'C-10' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C11 <- qnp %>% filter(Point_No == 'C-11' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C12 <- qnp %>% filter(Point_No == 'C-12' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C13 <- qnp %>% filter(Point_No == 'C-13' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C14 <- qnp %>% filter(Point_No == 'C-14' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C15 <- qnp %>% filter(Point_No == 'C-15' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C16 <- qnp %>% filter(Point_No == 'C-16' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C17 <- qnp %>% filter(Point_No == 'C-17' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C18 <- qnp %>% filter(Point_No == 'C-18' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C19 <- qnp %>% filter(Point_No == 'C-19' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C20 <- qnp %>% filter(Point_No == 'C-20' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C21 <- qnp %>% filter(Point_No == 'C-21' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_C22 <- qnp %>% filter(Point_No == 'C-22' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D1 <- qnp %>% filter(Point_No == 'D-01' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D2 <- qnp %>% filter(Point_No == 'D-02' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D3 <- qnp %>% filter(Point_No == 'D-03' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D4 <- qnp %>% filter(Point_No == 'D-04' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D5 <- qnp %>% filter(Point_No == 'D-05' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D6 <- qnp %>% filter(Point_No == 'D-06' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D7 <- qnp %>% filter(Point_No == 'D-07' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D8 <- qnp %>% filter(Point_No == 'D-08' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D9 <- qnp %>% filter(Point_No == 'D-09' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D10 <- qnp %>% filter(Point_No == 'D-10' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D11 <- qnp %>% filter(Point_No == 'D-11' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D12 <- qnp %>% filter(Point_No == 'D-12' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D13 <- qnp %>% filter(Point_No == 'D-13' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D14 <- qnp %>% filter(Point_No == 'D-14' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D15 <- qnp %>% filter(Point_No == 'D-15' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D16 <- qnp %>% filter(Point_No == 'D-16' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D17 <- qnp %>% filter(Point_No == 'D-17' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D18 <- qnp %>% filter(Point_No == 'D-18' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D19 <- qnp %>% filter(Point_No == 'D-19' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D20 <- qnp %>% filter(Point_No == 'D-20' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D21 <- qnp %>% filter(Point_No == 'D-21' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D22 <- qnp %>% filter(Point_No == 'D-22' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D23 <- qnp %>% filter(Point_No == 'D-23' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D24 <- qnp %>% filter(Point_No == 'D-24' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D25 <- qnp %>% filter(Point_No == 'D-25' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D26 <- qnp %>% filter(Point_No == 'D-26' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D27 <- qnp %>% filter(Point_No == 'D-27' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D28 <- qnp %>% filter(Point_No == 'D-28' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D29 <- qnp %>% filter(Point_No == 'D-29' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D30 <- qnp %>% filter(Point_No == 'D-30' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D31 <- qnp %>% filter(Point_No == 'D-31' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D32 <- qnp %>% filter(Point_No == 'D-32' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D33 <- qnp %>% filter(Point_No == 'D-33' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D34 <- qnp %>% filter(Point_No == 'D-34' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D35 <- qnp %>% filter(Point_No == 'D-35' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D36 <- qnp %>% filter(Point_No == 'D-36' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D37 <- qnp %>% filter(Point_No == 'D-37' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D38 <- qnp %>% filter(Point_No == 'D-38' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D39 <- qnp %>% filter(Point_No == 'D-39' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D40 <- qnp %>% filter(Point_No == 'D-40' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D41 <- qnp %>% filter(Point_No == 'D-41' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D42 <- qnp %>% filter(Point_No == 'D-42' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D43 <- qnp %>% filter(Point_No == 'D-43' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D44 <- qnp %>% filter(Point_No == 'D-44' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D45 <- qnp %>% filter(Point_No == 'D-45' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D46 <- qnp %>% filter(Point_No == 'D-46' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D47 <- qnp %>% filter(Point_No == 'D-47' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D48 <- qnp %>% filter(Point_No == 'D-48' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D49 <- qnp %>% filter(Point_No == 'D-49' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D50 <- qnp %>% filter(Point_No == 'D-50' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D51 <- qnp %>% filter(Point_No == 'D-51' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D52 <- qnp %>% filter(Point_No == 'D-52' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D53 <- qnp %>% filter(Point_No == 'D-53' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_D54 <- qnp %>% filter(Point_No == 'D-54' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F1 <- qnp %>% filter(Point_No == 'F-01' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F2 <- qnp %>% filter(Point_No == 'F-02' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F3 <- qnp %>% filter(Point_No == 'F-03' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F4 <- qnp %>% filter(Point_No == 'F-04' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F5 <- qnp %>% filter(Point_No == 'F-05' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F6 <- qnp %>% filter(Point_No == 'F-06' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F7 <- qnp %>% filter(Point_No == 'F-07' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F8 <- qnp %>% filter(Point_No == 'F-08' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
I_PN_F9 <- qnp %>% filter(Point_No == 'F-09' & Inflow_Spill == '유입') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)

I_PN_B <- rbind(I_PN_B1, I_PN_B2, I_PN_B3, I_PN_B4, I_PN_B5, I_PN_B6, I_PN_B7, I_PN_B8, I_PN_B9, I_PN_B10, I_PN_B11, I_PN_B14, I_PN_B15, I_PN_B17, I_PN_B18, I_PN_B19, I_PN_B20, I_PN_B21, I_PN_B22, I_PN_B23, I_PN_B25, I_PN_B26, I_PN_B27, I_PN_B28, I_PN_B29, I_PN_B31, I_PN_B32, I_PN_B33, I_PN_B34, I_PN_B35, I_PN_B36)
# B지점 컬럼이 일부 없는 번호 (12, 13, 16, 24, 30, 37)

I_PN_C <- rbind(I_PN_C1, I_PN_C3, I_PN_C4, I_PN_C5, I_PN_C6, I_PN_C7, I_PN_C8, I_PN_C9, I_PN_C10, I_PN_C11, I_PN_C12, I_PN_C13, I_PN_C14, I_PN_C15, I_PN_C16, I_PN_C17, I_PN_C18, I_PN_C19, I_PN_C20, I_PN_C21)
# C지점 컬럼이 일부 없는 번호(2, 22)

I_PN_D <- rbind(I_PN_D1, I_PN_D2, I_PN_D3, I_PN_D4, I_PN_D5, I_PN_D6, I_PN_D7, I_PN_D8, I_PN_D9, I_PN_D10, I_PN_D11, I_PN_D12, I_PN_D14, I_PN_D15, I_PN_D16, I_PN_D17, I_PN_D18, I_PN_D19, I_PN_D20, I_PN_D22, I_PN_D23, I_PN_D25, I_PN_D27, I_PN_D28, I_PN_D29, I_PN_D30, I_PN_D31, I_PN_D32, I_PN_D33, I_PN_D34, I_PN_D35, I_PN_D36, I_PN_D37, I_PN_D38, I_PN_D39, I_PN_D40, I_PN_D41, I_PN_D42, I_PN_D43, I_PN_D44, I_PN_D45)
# D지점 컬럼이 일부 없는 번호(13, 21, 24, 26, 46, 47, 48, 49, 50, 51, 52, 53, 54)

I_PN_F <- rbind(I_PN_F1, I_PN_F2, I_PN_F3, I_PN_F4, I_PN_F5, I_PN_F6, I_PN_F7, I_PN_F8, I_PN_F9)

# write.csv(I_PN_D54, 'c:/Big Data Contest/I_PN/I_PN_D54.csv')

#ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ유출ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
S_PN_B1 <- qnp %>% filter(Point_No == 'B-01'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B2 <- qnp %>% filter(Point_No == 'B-02'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B3 <- qnp %>% filter(Point_No == 'B-03'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B4 <- qnp %>% filter(Point_No == 'B-04'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B5 <- qnp %>% filter(Point_No == 'B-05'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B6 <- qnp %>% filter(Point_No == 'B-06'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B7 <- qnp %>% filter(Point_No == 'B-07'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B8 <- qnp %>% filter(Point_No == 'B-08'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B9 <- qnp %>% filter(Point_No == 'B-09'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B10 <- qnp %>% filter(Point_No == 'B-10'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B11 <- qnp %>% filter(Point_No == 'B-11'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B12 <- qnp %>% filter(Point_No == 'B-12'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B13 <- qnp %>% filter(Point_No == 'B-13'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B14 <- qnp %>% filter(Point_No == 'B-14'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B15 <- qnp %>% filter(Point_No == 'B-15'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B16 <- qnp %>% filter(Point_No == 'B-16'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B17 <- qnp %>% filter(Point_No == 'B-17'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B18 <- qnp %>% filter(Point_No == 'B-18'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B19 <- qnp %>% filter(Point_No == 'B-19'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B20 <- qnp %>% filter(Point_No == 'B-20'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B21 <- qnp %>% filter(Point_No == 'B-21'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B22 <- qnp %>% filter(Point_No == 'B-22'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B23 <- qnp %>% filter(Point_No == 'B-23'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B24 <- qnp %>% filter(Point_No == 'B-24'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B25 <- qnp %>% filter(Point_No == 'B-25'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B26 <- qnp %>% filter(Point_No == 'B-26'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B27 <- qnp %>% filter(Point_No == 'B-27'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B28 <- qnp %>% filter(Point_No == 'B-28'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B29 <- qnp %>% filter(Point_No == 'B-29'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B30 <- qnp %>% filter(Point_No == 'B-30'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B31 <- qnp %>% filter(Point_No == 'B-31'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B32 <- qnp %>% filter(Point_No == 'B-32'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B33 <- qnp %>% filter(Point_No == 'B-33'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B34 <- qnp %>% filter(Point_No == 'B-34'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B35 <- qnp %>% filter(Point_No == 'B-35'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B36 <- qnp %>% filter(Point_No == 'B-36'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_B37 <- qnp %>% filter(Point_No == 'B-37'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C1 <- qnp %>% filter(Point_No == 'C-01'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C2 <- qnp %>% filter(Point_No == 'C-02'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C3 <- qnp %>% filter(Point_No == 'C-03'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C4 <- qnp %>% filter(Point_No == 'C-04'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C5 <- qnp %>% filter(Point_No == 'C-05'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C6 <- qnp %>% filter(Point_No == 'C-06'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C7 <- qnp %>% filter(Point_No == 'C-07'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C8 <- qnp %>% filter(Point_No == 'C-08'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C9 <- qnp %>% filter(Point_No == 'C-09'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C10 <- qnp %>% filter(Point_No == 'C-10'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C11 <- qnp %>% filter(Point_No == 'C-11'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C12 <- qnp %>% filter(Point_No == 'C-12'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C13 <- qnp %>% filter(Point_No == 'C-13'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C14 <- qnp %>% filter(Point_No == 'C-14'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C15 <- qnp %>% filter(Point_No == 'C-15'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C16 <- qnp %>% filter(Point_No == 'C-16'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C17 <- qnp %>% filter(Point_No == 'C-17'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C18 <- qnp %>% filter(Point_No == 'C-18'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C19 <- qnp %>% filter(Point_No == 'C-19'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C20 <- qnp %>% filter(Point_No == 'C-20'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C21 <- qnp %>% filter(Point_No == 'C-21'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_C22 <- qnp %>% filter(Point_No == 'C-22'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D1 <- qnp %>% filter(Point_No == 'D-01'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D2 <- qnp %>% filter(Point_No == 'D-02'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D3 <- qnp %>% filter(Point_No == 'D-03'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D4 <- qnp %>% filter(Point_No == 'D-04'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D5 <- qnp %>% filter(Point_No == 'D-05'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D6 <- qnp %>% filter(Point_No == 'D-06'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D7 <- qnp %>% filter(Point_No == 'D-07'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D8 <- qnp %>% filter(Point_No == 'D-08'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D9 <- qnp %>% filter(Point_No == 'D-09'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D10 <- qnp %>% filter(Point_No == 'D-10'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D11 <- qnp %>% filter(Point_No == 'D-11'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D12 <- qnp %>% filter(Point_No == 'D-12'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D13 <- qnp %>% filter(Point_No == 'D-13'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D14 <- qnp %>% filter(Point_No == 'D-14'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D15 <- qnp %>% filter(Point_No == 'D-15'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D16 <- qnp %>% filter(Point_No == 'D-16'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D17 <- qnp %>% filter(Point_No == 'D-17'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D18 <- qnp %>% filter(Point_No == 'D-18'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D19 <- qnp %>% filter(Point_No == 'D-19'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D20 <- qnp %>% filter(Point_No == 'D-20'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D21 <- qnp %>% filter(Point_No == 'D-21'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D22 <- qnp %>% filter(Point_No == 'D-22'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D23 <- qnp %>% filter(Point_No == 'D-23'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D24 <- qnp %>% filter(Point_No == 'D-24'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D25 <- qnp %>% filter(Point_No == 'D-25'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D26 <- qnp %>% filter(Point_No == 'D-26'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D27 <- qnp %>% filter(Point_No == 'D-27'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D28 <- qnp %>% filter(Point_No == 'D-28'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D29 <- qnp %>% filter(Point_No == 'D-29'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D30 <- qnp %>% filter(Point_No == 'D-30'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D31 <- qnp %>% filter(Point_No == 'D-31'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D32 <- qnp %>% filter(Point_No == 'D-32'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D33 <- qnp %>% filter(Point_No == 'D-33'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D34 <- qnp %>% filter(Point_No == 'D-34'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D35 <- qnp %>% filter(Point_No == 'D-35'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D36 <- qnp %>% filter(Point_No == 'D-36'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D37 <- qnp %>% filter(Point_No == 'D-37'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D38 <- qnp %>% filter(Point_No == 'D-38'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D39 <- qnp %>% filter(Point_No == 'D-39'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D40 <- qnp %>% filter(Point_No == 'D-40'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D41 <- qnp %>% filter(Point_No == 'D-41'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D42 <- qnp %>% filter(Point_No == 'D-42'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D43 <- qnp %>% filter(Point_No == 'D-43'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D44 <- qnp %>% filter(Point_No == 'D-44'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D45 <- qnp %>% filter(Point_No == 'D-45'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D46 <- qnp %>% filter(Point_No == 'D-46'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D47 <- qnp %>% filter(Point_No == 'D-47'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D48 <- qnp %>% filter(Point_No == 'D-48'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D49 <- qnp %>% filter(Point_No == 'D-49'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D50 <- qnp %>% filter(Point_No == 'D-50'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D51 <- qnp %>% filter(Point_No == 'D-51'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D52 <- qnp %>% filter(Point_No == 'D-52'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D53 <- qnp %>% filter(Point_No == 'D-53'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_D54 <- qnp %>% filter(Point_No == 'D-54'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F1 <- qnp %>% filter(Point_No == 'F-01'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F2 <- qnp %>% filter(Point_No == 'F-02'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F3 <- qnp %>% filter(Point_No == 'F-03'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F4 <- qnp %>% filter(Point_No == 'F-04'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F5 <- qnp %>% filter(Point_No == 'F-05'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F6 <- qnp %>% filter(Point_No == 'F-06'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F7 <- qnp %>% filter(Point_No == 'F-07'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F8 <- qnp %>% filter(Point_No == 'F-08'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)
S_PN_F9 <- qnp %>% filter(Point_No == 'F-09'& Inflow_Spill == '유출') %>% mutate(ratio = allsum/alln) %>% mutate(lag_ratio = lag(ratio, 1)) %>% mutate(per_val = (ratio - lag_ratio) / ( lag_ratio/100)) %>% select(Point_No, Year, per_val) %>% spread(key=Year, value=per_val)

S_PN_B <- rbind(S_PN_B1, S_PN_B2, S_PN_B3, S_PN_B4, S_PN_B5, S_PN_B6, S_PN_B7, S_PN_B8, S_PN_B9, S_PN_B10, S_PN_B11, S_PN_B14, S_PN_B15, S_PN_B17, S_PN_B19, S_PN_B20, S_PN_B21, S_PN_B22, S_PN_B23, S_PN_B25, S_PN_B26, S_PN_B27, S_PN_B28, S_PN_B29, S_PN_B31, S_PN_B32, S_PN_B33, S_PN_B34, S_PN_B35, S_PN_B36)
# B지점 컬럼이 일부 없는 번호( 12, 13, 16, 18, 24, 30, 37)

S_PN_C <- rbind(S_PN_C1, S_PN_C3, S_PN_C4, S_PN_C5, S_PN_C6, S_PN_C7, S_PN_C8, S_PN_C9, S_PN_C10, S_PN_C11, S_PN_C12, S_PN_C13, S_PN_C14, S_PN_C15, S_PN_C16, S_PN_C17, S_PN_C18, S_PN_C19, S_PN_C20, S_PN_C21)
# C지점 컬럼이 일부 없는 번호( 2, 22)

S_PN_D <- rbind(S_PN_D1, S_PN_D2, S_PN_D3, S_PN_D4, S_PN_D6, S_PN_D7, S_PN_D8, S_PN_D9, S_PN_D10, S_PN_D11, S_PN_D12, S_PN_D13, S_PN_D15, S_PN_D16, S_PN_D17, S_PN_D18, S_PN_D19, S_PN_D20, S_PN_D22, S_PN_D25, S_PN_D29, S_PN_D30, S_PN_D31, S_PN_D32, S_PN_D33, S_PN_D34, S_PN_D35, S_PN_D36, S_PN_D37, S_PN_D38, S_PN_D39, S_PN_D40, S_PN_D41, S_PN_D42, S_PN_D43)
# D지점 컬럼이 일부 없는 번호 (5, 14, 21, 23, 24, 26, 27, 28, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54)

S_PN_F <- rbind(S_PN_F1, S_PN_F2, S_PN_F3, S_PN_F4, S_PN_F5, S_PN_F6, S_PN_F7, S_PN_F8, S_PN_F9)

# write.csv(S_PN_D54, 'c:/Big Data Contest/S_PN/S_PN_D54.csv')

